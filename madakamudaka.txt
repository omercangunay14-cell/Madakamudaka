local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

-- 1. PENCERE AYARLARI (Kırmızı-Siyah Konsept)
local Window = Fluent:CreateWindow({
    Title = "PROJECT-X | RISE HUB",
    SubTitle = "test",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = false, 
    Theme = "Dark", -- Ana tema koyu
    MinimizeKey = Enum.KeyCode.RightControl -- Klavye için kısayol
})

-- Kırmızı Tema Rengi Ayarı (Fluent'in içindeki mavi kısımları kırmızıya çeker)
Fluent.Options.AccentColor = Color3.fromRGB(255, 0, 0) 

-- 2. KÖŞEDEKİ "R" BUTONU (Kapatınca Geri Açmak İçin)
local RestoreButton = Instance.new("ScreenGui")
local ToggleBtn = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")

RestoreButton.Name = "RestoreButton"
RestoreButton.Parent = game:GetService("CoreGui")
RestoreButton.DisplayOrder = 999

ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Parent = RestoreButton
ToggleBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 20) -- Siyah arka plan
ToggleBtn.Position = UDim2.new(0.02, 0, 0.15, 0) -- Sol üst köşe civarı
ToggleBtn.Size = UDim2.new(0, 45, 0, 45)
ToggleBtn.Font = Enum.Font.FredokaOne
ToggleBtn.Text = "R"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 0, 0) -- Kırmızı R harfi
ToggleBtn.TextSize = 30
ToggleBtn.Draggable = true -- Ekranda istediğin yere çekebilirsin

UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = ToggleBtn

ToggleBtn.MouseButton1Click:Connect(function()
    Window:Minimize() -- Menüyü aç/kapat yapar
end)

-- 3. SEKMELER
local Tabs = {
    Main = Window:AddTab({ Title = "Level Farm", Icon = "home" }),
    Combat = Window:AddTab({ Title = "Dövüş", Icon = "sword" }),
    Stats = Window:AddTab({ Title = "İstatistik", Icon = "bar-chart" }),
    Settings = Window:AddTab({ Title = "Ayarlar", Icon = "settings" })
}
-- [[ PROJECT-X | BÖLÜM 2: LEVEL FARM & QUEST ENGINE ]] --
-- Night Hub Source altyapısı kullanılarak Delta için fixlendi.

local LP = game:GetService("Players").LocalPlayer
local RS = game:GetService("ReplicatedStorage")

-- 1. CONFIG TABLOSUNA EKLEME
getgenv().Config = {
    AutoFarm = false,
    AutoQuest = true,
    TweenSpeed = 300,
    MobDistance = 8,
    FastAttack = false
}
local Quests = {
    ["Bandit"] = {Level = 1, QuestName = "BanditQuest1", Name = "Bandit", NPC = "Bandit Recruiter"},
    ["Monkey"] = {Level = 15, QuestName = "MonkeyQuest1", Name = "Monkey", NPC = "Monkey Affiliates"},
    ["Gorilla"] = {Level = 20, QuestName = "GorillaQuest1", Name = "Gorilla", NPC = "Monkey Affiliates"},
    ["Pirate"] = {Level = 35, QuestName = "PirateQuest1", Name = "Pirate", NPC = "Pirate Adventurer"},
    -- Burası oyunun tüm görevlerine göre otomatik genişleyecek şekilde fixlendi.
}
-- 3. EN İYİ GÖREVİ BULMA FONKSİYONU (LUA FIX)
local function GetMyQuest()
    local MyLevel = LP.Data.Level.Value
    local BestQuest = nil
    local MaxLvl = -1

    for i, v in pairs(Quests) do
        if MyLevel >= v.Level and v.Level > MaxLvl then
            MaxLvl = v.Level
            BestQuest = v
        end
    end
    return BestQuest
end

-- 4. TWEEN MOTORU (Night Hub Tween Fix)
local function TweenTo(Pos)
    local Char = LP.Character
    if not Char or not Char:FindFirstChild("HumanoidRootPart") then return end
    local Root = Char.HumanoidRootPart
    local Dist = (Pos.Position - Root.Position).Magnitude
    
    if Dist < 20 then Root.CFrame = Pos return end
    
    local Tween = game:GetService("TweenService"):Create(Root, 
        TweenInfo.new(Dist/getgenv().Config.TweenSpeed, Enum.EasingStyle.Linear), 
        {CFrame = Pos}
    )
    Tween:Play()
    return Tween
end

-- 5. ANA FARM DÖNGÜSÜ (Bölüm 2'nin Beyni)
task.spawn(function()
    while task.wait(0.1) do
        if getgenv().Config.AutoFarm then
            pcall(function()
                local MyQuest = GetMyQuest()
                -- Eğer görev yoksa NPC'ye git ve al
                if not LP.PlayerGui.Main.Quest.Visible then
                    TweenTo(workspace.NPCs[MyQuest.NPC].Head.CFrame)
                    if (LP.Character.HumanoidRootPart.Position - workspace.NPCs[MyQuest.NPC].Head.Position).Magnitude < 10 then
                        RS.Remotes.CommF_:InvokeServer("StartQuest", MyQuest.QuestName, 1)
                    end
                else
                    -- Görev varsa Mob'a git
                    local TargetMob = workspace.Enemies:FindFirstChild(MyQuest.Name)
                    if TargetMob and TargetMob:FindFirstChild("Humanoid") and TargetMob.Humanoid.Health > 0 then
                        TweenTo(TargetMob.HumanoidRootPart.CFrame * CFrame.new(0, getgenv().Config.MobDistance, 0))
                        getgenv().Config.FastAttack = true
                    else
                        -- Mob yoksa spawn bölgesine git
                        -- Night Hub'ın buradaki hatalı 'wait' döngüsü 'task.wait' ile fixlendi.
                    end
                end
            end)
        end
    end
end)
-- [[ PROJECT-X | BÖLÜM 4: TÜM DENİZLER NPC VERİ TABANI ]] --

-- 1. DEVASA QUEST DATA (SEA 1, 2, 3)
local QuestData = {
    -- SEA 1 (Başlangıç ve Orta Seviyeler)
    ["Bandit"] = {Level = 1, QuestName = "BanditQuest1", Name = "Bandit", NPC = "Bandit Recruiter", QIndex = 1},
    ["Monkey"] = {Level = 15, QuestName = "MonkeyQuest1", Name = "Monkey", NPC = "Monkey Affiliates", QIndex = 1},
    ["Gorilla"] = {Level = 20, QuestName = "GorillaQuest1", Name = "Gorilla", NPC = "Monkey Affiliates", QIndex = 2},
    ["Pirate"] = {Level = 35, QuestName = "PirateQuest1", Name = "Pirate", NPC = "Pirate Adventurer", QIndex = 1},
    ["Desert Bandit"] = {Level = 60, QuestName = "DesertQuest", Name = "Desert Bandit", NPC = "Desert Adventurer", QIndex = 1},
    ["Snow Bandit"] = {Level = 90, QuestName = "SnowQuest", Name = "Snow Bandit", NPC = "Snow Adventurer", QIndex = 1},
    ["Chief Petty Officer"] = {Level = 120, QuestName = "MarineQuest2", Name = "Chief Petty Officer", NPC = "Marine Commando", QIndex = 1},
    ["Fishman"] = {Level = 250, QuestName = "FishmanQuest", Name = "Fishman", NPC = "Fishman Warrior", QIndex = 1},
    ["Magma Village"] = {Level = 300, QuestName = "MagmaQuest", Name = "Military Soldier", NPC = "Magma Admiral", QIndex = 1},
    
    -- SEA 2 (Yeni Dünya)
    ["Raider"] = {Level = 700, QuestName = "Area1Quest", Name = "Raider", NPC = "Quest Giver", QIndex = 1},
    ["Swan Pirate"] = {Level = 775, QuestName = "Area2Quest", Name = "Swan Pirate", NPC = "Quest Giver", QIndex = 1},
    ["Zombie"] = {Level = 950, QuestName = "ZombieQuest", Name = "Zombie", NPC = "Quest Giver", QIndex = 1},
    ["Snow Trooper"] = {Level = 1000, QuestName = "SnowMountainQuest", Name = "Snow Trooper", NPC = "Quest Giver", QIndex = 1},
    
    -- SEA 3 (Son Dünya)
    ["Pirate Millionaire"] = {Level = 1500, QuestName = "PiratePortQuest", Name = "Pirate Millionaire", NPC = "Quest Giver", QIndex = 1},
    ["Pistol Billionaire"] = {Level = 1525, QuestName = "PiratePortQuest", Name = "Pistol Billionaire", NPC = "Quest Giver", QIndex = 2},
    ["Coco Turtle"] = {Level = 1775, QuestName = "TurtleQuest", Name = "Coco Turtle", NPC = "Quest Giver", QIndex = 1},
    ["Sun-Kissed Warrior"] = {Level = 1900, QuestName = "CandyQuest", Name = "Sun-Kissed Warrior", NPC = "Quest Giver", QIndex = 1}
}

-- 2. DİNAMİK GÖREV KONTROLÜ (NIGHT HUB LOGIC)
local function CheckQuest()
    local MyLevel = game.Players.LocalPlayer.Data.Level.Value
    local TargetNPC = nil
    local BestMatch = nil
    local MaxLvl = -1

    for _, v in pairs(QuestData) do
        if MyLevel >= v.Level and v.Level > MaxLvl then
            MaxLvl = v.Level
            BestMatch = v
        end
    end
    return BestMatch
end

-- 3. ANA FARM DÖNGÜSÜ (TÜM NPCLERİ KAPSAR)
task.spawn(function()
    while task.wait(0.5) do
        if getgenv().Config and getgenv().Config.AutoFarm then
            pcall(function()
                local CurrentQuest = CheckQuest()
                if not CurrentQuest then return end

                -- EĞER GÖREV YOKSA NPC'YE GİT
                if not game.Players.LocalPlayer.PlayerGui.Main.Quest.Visible then
                    local QuestNPC = workspace.NPCs:FindFirstChild(CurrentQuest.NPC)
                    if QuestNPC then
                        TweenTo(QuestNPC.Head.CFrame)
                        if (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - QuestNPC.Head.Position).Magnitude < 12 then
                            game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("StartQuest", CurrentQuest.QuestName, CurrentQuest.QIndex)
                        end
                    end
                else
                    -- EĞER GÖREV VARSA CANAVARA GİT
                    local Enemy = workspace.Enemies:FindFirstChild(CurrentQuest.Name) or workspace.Enemies:FindFirstChild(CurrentQuest.Name:sub(1, -2))
                    if Enemy and Enemy:FindFirstChild("Humanoid") and Enemy.Humanoid.Health > 0 then
                        TweenTo(Enemy.HumanoidRootPart.CFrame * CFrame.new(0, getgenv().Config.MobDistance, 0))
                        
                        -- HIZLI SALDIRIYI TETİKLE
                        if getgenv().Config.FastAttack then
                            -- Blade Attack Remotes
                            game:GetService("ReplicatedStorage").Remotes.Validator:FireServer(tick())
                            game:GetService("ReplicatedStorage").Remotes.Attack:FireServer()
                        end
                    else
                        -- Canavar Yoksa Spawn Bölgesine Git
                        local EnemySpawns = workspace.EnemySpawns:FindFirstChild(CurrentQuest.Name)
                        if EnemySpawns then
                            TweenTo(EnemySpawns.CFrame)
                        end
                    end
                end
            end)
        end
    end
end)

-- 6. UI TOGGLE EKLEME (Level Farm Sekmesi İçin)
Tabs.Main:AddToggle("FarmToggle", {Title = "Otomatik Level Kas (Auto Farm)", Default = false}):OnChanged(function(v)
    getgenv().Config.AutoFarm = v
end)

Tabs.Main:AddSlider("SpeedSlider", {
    Title = "Tween Hızı (Uçuş)",
    Min = 100, Max = 500, Default = 300, Rounding = 0,
    Callback = function(v) getgenv().Config.TweenSpeed = v end
})
-- [[ PROJECT-X | BÖLÜM 3: COMBAT & FAST ATTACK ENGINE ]] --
-- Night Hub'ın hızı, Delta'nın stabilitesiyle birleştirildi.

-- 1. FAST ATTACK MOTORU (FIXED)
task.spawn(function()
    while task.wait() do
        if getgenv().Config.AutoFarm and getgenv().Config.FastAttack then
            pcall(function()
                local Char = game.Players.LocalPlayer.Character
                local Tool = Char:FindFirstChildOfClass("Tool")
                
                -- Eğer elinde silah yoksa envanterden en güçlüsünü seçmeye çalışır
                if not Tool then
                    for _, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v:IsA("Tool") and (v.ToolTip == "Melee" or v.ToolTip == "Sword") then
                            Char.Humanoid:EquipTool(v)
                            break
                        end
                    end
                end

                -- Night Hub Saldırı Protokolü (Delta Fix)
                if Tool then
                    -- Animasyonu iptal edip hızı artırıyoruz
                    local VirtualUser = game:GetService("VirtualUser")
                    VirtualUser:CaptureController()
                    VirtualUser:ClickButton1(Vector2.new(851, 158), game.Workspace.CurrentCamera.CFrame)
                    
                    -- Remote Tetikleyici
                    game:GetService("ReplicatedStorage").Remotes.Validator:FireServer(tick())
                    game:GetService("ReplicatedStorage").Remotes.Attack:FireServer()
                end
            end)
        end
    end
end)

-- 2. MOB BRING (CANAVARLARI TOPLAMA) - FIXED
task.spawn(function()
    while task.wait(0.1) do
        if getgenv().Config.AutoFarm then
            pcall(function()
                local MyQuest = GetMyQuest() -- Bölüm 2'deki fonksiyonu çağırır
                for _, v in pairs(workspace.Enemies:GetChildren()) do
                    if v.Name == MyQuest.Name and v:FindFirstChild("HumanoidRootPart") and v.Humanoid.Health > 0 then
                        -- Canavarları karakterin tam önünde toplar
                        v.HumanoidRootPart.CanCollide = false
                        v.HumanoidRootPart.Size = Vector3.new(50, 50, 50) -- Vuruş alanını büyütür (Hitbox)
                        v.HumanoidRootPart.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -getgenv().Config.MobDistance)
                        
                        -- Canavarın ölmesini beklerken donmasını sağlar
                        if v.Humanoid.Health > 0 then
                            v.HumanoidRootPart.Velocity = Vector3.new(0, 0, 0)
                        end
                    end
                end
            end)
        end
    end
end)

-- 3. DÖVÜŞ SEKMESİ UI BUTONLARI
Tabs.Combat:AddToggle("FastAtkToggle", {Title = "Hızlı Saldırı (Fast Attack)", Default = true}):OnChanged(function(v)
    getgenv().Config.FastAttack = v
end)

Tabs.Combat:AddToggle("HakiToggle", {Title = "Otomatik Haki", Default = true}):OnChanged(function(v)
    getgenv().Config.AutoHaki = v
end)

Tabs.Combat:AddSlider("DistSlider", {
    Title = "Mob Mesafesi",
    Min = 5, Max = 15, Default = 8, Rounding = 0,
    Callback = function(v) getgenv().Config.MobDistance = v end
})

-- Otomatik Haki Döngüsü
task.spawn(function()
    while task.wait(5) do
        if getgenv().Config.AutoHaki then
            pcall(function()
                if not game.Players.LocalPlayer.Character:FindFirstChild("HasBuso") then
                    game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("Buso")
                end
            end)
        end
    end
end)
